{
  "metadata": {
    "title": "Axiom Protocol Security Risk Register",
    "version": "1.1",
    "auditDate": "2025-12-16",
    "network": "Arbitrum One",
    "chainId": 42161,
    "totalContracts": 24,
    "compiler": "solc 0.8.20"
  },
  "summary": {
    "slitherRaw": {
      "critical": 0,
      "high": 12,
      "medium": 30,
      "low": 137,
      "informational": 89
    },
    "afterTriage": {
      "critical": 0,
      "high": 3,
      "medium": 8,
      "low": 12,
      "informational": 89,
      "triaged": {
        "falsePositive": 1,
        "lowRisk": 8
      },
      "notes": "3 VALID HIGH findings all addressed: H-01 FIXED, H-02 FIXED, H-03 DOCUMENTED"
    },
    "remediationStatus": {
      "fixed": 2,
      "documented": 1,
      "open": 0,
      "lastUpdated": "2025-12-16"
    }
  },
  "keyAddresses": {
    "deployer": "0xDFf9e47eb007bF02e47477d577De9ffA99791528",
    "treasury": "0x2bB2c2A7a1d82097488bf0b9c2a59c1910CD8D5d",
    "axmToken": "0x864F9c6f50dC5Bd244F5002F1B0873Cd80e2539D"
  },
  "slitherTriageSummary": [
    {
      "slitherId": 1,
      "finding": "arbitrary-send-erc20",
      "contract": "DePINNodeSuite",
      "function": "createLease",
      "verdict": "VALID",
      "reason": "msg.sender != lessee not validated"
    },
    {
      "slitherId": 2,
      "finding": "arbitrary-send-erc20",
      "contract": "LeaseAndRentEngine",
      "function": "createLease (securityDeposit)",
      "verdict": "VALID",
      "reason": "msg.sender != tenant not validated"
    },
    {
      "slitherId": 3,
      "finding": "arbitrary-send-erc20",
      "contract": "LeaseAndRentEngine",
      "function": "createLease (purchasePrice)",
      "verdict": "VALID",
      "reason": "msg.sender != tenant not validated"
    },
    {
      "slitherId": 4,
      "finding": "arbitrary-send-eth",
      "contract": "DePINNodeSales",
      "function": "emergencyWithdrawETH",
      "verdict": "LOW_RISK",
      "reason": "Admin-only function sends to treasurySafe (not arbitrary)"
    },
    {
      "slitherId": 5,
      "finding": "arbitrary-send-eth",
      "contract": "SustainabilityHub",
      "function": "withdraw",
      "verdict": "LOW_RISK",
      "reason": "Has onlyRole(ADMIN_ROLE) - NOT unprotected. Sends to admin caller."
    },
    {
      "slitherId": 6,
      "finding": "weak-prng",
      "contract": "AxiomSusuHub",
      "function": "_generateRandomOrder",
      "verdict": "VALID",
      "reason": "Block-based randomness is predictable by validators"
    },
    {
      "slitherId": 7,
      "finding": "incorrect-exp",
      "contract": "Math (OpenZeppelin)",
      "function": "mulDiv",
      "verdict": "FALSE_POSITIVE",
      "reason": "Intentional XOR in OZ Newton-Raphson iteration"
    },
    {
      "slitherId": 8,
      "finding": "uninitialized-state",
      "contract": "OracleAndMetricsRelay",
      "variable": "assetOracles",
      "verdict": "LOW_RISK",
      "reason": "Solidity auto-initializes mappings"
    },
    {
      "slitherId": 9,
      "finding": "uninitialized-state",
      "contract": "AxiomAcademyHub",
      "variable": "moduleLessons",
      "verdict": "LOW_RISK",
      "reason": "Solidity auto-initializes mappings"
    },
    {
      "slitherId": 10,
      "finding": "uninitialized-state",
      "contract": "AxiomAcademyHub",
      "variable": "courseModules",
      "verdict": "LOW_RISK",
      "reason": "Solidity auto-initializes mappings"
    },
    {
      "slitherId": 11,
      "finding": "uninitialized-state",
      "contract": "CommunitySocialHub",
      "variable": "postComments",
      "verdict": "LOW_RISK",
      "reason": "Solidity auto-initializes mappings"
    },
    {
      "slitherId": 12,
      "finding": "uninitialized-state",
      "contract": "GamificationHub",
      "variable": "questObjectives",
      "verdict": "LOW_RISK",
      "reason": "Solidity auto-initializes mappings"
    }
  ],
  "findings": [
    {
      "id": "H-01",
      "title": "Arbitrary transferFrom in DePINNodeSuite.createLease()",
      "severity": "HIGH",
      "impact": "HIGH",
      "likelihood": "LOW",
      "contract": "DePINNodeSuite",
      "address": "0x16dC3884d88b767D99E0701Ba026a1ed39a250F1",
      "file": "contracts/DePINNodeSuite.sol",
      "lines": "390-475",
      "function": "createLease / createLeaseAsAdmin",
      "category": "arbitrary-send-erc20",
      "description": "Function uses safeTransferFrom with caller-provided lessee address without validating msg.sender == lessee. If victim has approved contract, attacker can drain their tokens.",
      "recommendation": "Add validation: require(msg.sender == lessee, 'Sender must be lessee')",
      "status": "FIXED",
      "fixDate": "2025-12-16",
      "fixDescription": "Split into createLease() (lessee calls, transfers from msg.sender) and createLeaseAsAdmin() (admin-only, uses pre-deposited funds)",
      "exploitable": false,
      "cvss": 0
    },
    {
      "id": "H-02",
      "title": "Arbitrary transferFrom in LeaseAndRentEngine.createLease()",
      "severity": "HIGH",
      "impact": "HIGH",
      "likelihood": "LOW",
      "contract": "LeaseAndRentEngine",
      "address": "0x26a20dEa57F951571AD6e518DFb3dC60634D5297",
      "file": "contracts/LeaseAndRentEngine.sol",
      "lines": "255-422",
      "function": "createLease / createLeaseAsAdmin",
      "category": "arbitrary-send-erc20",
      "description": "Function transfers tokens from caller-provided tenant address without validating msg.sender == tenant. Two separate transfers affected.",
      "recommendation": "Add sender validation: require(msg.sender == tenant, 'Sender must be tenant')",
      "status": "FIXED",
      "fixDate": "2025-12-16",
      "fixDescription": "Split into createLease() (tenant calls, transfers from msg.sender) and createLeaseAsAdmin() (admin-only, uses pre-deposited funds)",
      "exploitable": false,
      "cvss": 0
    },
    {
      "id": "H-03",
      "title": "Weak PRNG in AxiomSusuHub._generateRandomOrder()",
      "severity": "HIGH",
      "impact": "HIGH",
      "likelihood": "MEDIUM",
      "contract": "AxiomSusuHub",
      "address": "0x6C69D730327930B49A7997B7b5fb0865F30c95A5",
      "file": "contracts/AxiomSusuHub.sol",
      "lines": "583-625",
      "function": "_generateRandomOrder",
      "category": "weak-prng",
      "description": "Randomization uses block-based entropy (blockhash, block.timestamp) which is predictable. Miners/validators can influence payout order.",
      "recommendation": "Use Chainlink VRF for secure randomness or implement commit-reveal scheme",
      "status": "DOCUMENTED",
      "fixDate": "2025-12-16",
      "fixDescription": "Added comprehensive NatSpec warning documenting the limitation. Acceptable for trusted communities/low-value pools. Recommends Chainlink VRF for high-stakes pools.",
      "exploitable": true,
      "cvss": 6.0
    },
    {
      "id": "H-04",
      "title": "ETH Sent to treasurySafe in emergencyWithdrawETH() (Triaged: LOW RISK)",
      "severity": "LOW",
      "triageResult": "DOWNGRADED",
      "originalSeverity": "HIGH",
      "impact": "LOW",
      "likelihood": "LOW",
      "contract": "DePINNodeSales",
      "address": "0x876951CaE4Ad48bdBfba547Ef4316Db576A9Edbd",
      "file": "contracts/DePINNodeSales.sol",
      "lines": "661-669",
      "function": "emergencyWithdrawETH",
      "category": "arbitrary-send-eth",
      "description": "Slither flags as 'sends ETH to arbitrary user' but the recipient is treasurySafe (admin-controlled). Admin-only function with intended behavior.",
      "recommendation": "Consider implementing timelock for treasury address changes",
      "status": "TRIAGED",
      "exploitable": false,
      "cvss": 2.5
    },
    {
      "id": "H-05",
      "title": "ETH Sent to Admin Caller in SustainabilityHub.withdraw() (Triaged: LOW RISK)",
      "severity": "LOW",
      "triageResult": "DOWNGRADED",
      "originalSeverity": "HIGH",
      "impact": "LOW",
      "likelihood": "LOW",
      "contract": "SustainabilityHub",
      "address": "0xAf4dF8a7733BAB64b7Ce83F2494d6446eF9eC046",
      "file": "contracts/SustainabilityHub.sol",
      "lines": "648-650",
      "function": "withdraw",
      "category": "arbitrary-send-eth",
      "description": "Slither flags as 'sends ETH to arbitrary user' but function HAS onlyRole(ADMIN_ROLE). ETH is sent to admin caller, not arbitrary address. Intentional admin fund recovery behavior.",
      "recommendation": "Consider routing to fixed treasury address instead of msg.sender",
      "status": "TRIAGED",
      "exploitable": false,
      "cvss": 2.0
    },
    {
      "id": "H-06",
      "title": "Uninitialized State Variable Arrays (Triaged: LOW RISK)",
      "severity": "LOW",
      "triageResult": "DOWNGRADED",
      "originalSeverity": "HIGH",
      "impact": "NONE",
      "likelihood": "NONE",
      "contract": "Multiple",
      "address": "various",
      "file": "Multiple files",
      "lines": "various",
      "function": "various",
      "category": "uninitialized-state",
      "description": "Slither flags 5 mapping arrays as never initialized. In Solidity, mappings are automatically initialized to empty. This is standard behavior and not a vulnerability.",
      "recommendation": "No action required - standard Solidity behavior",
      "status": "TRIAGED",
      "exploitable": false,
      "cvss": 0
    },
    {
      "id": "H-07",
      "title": "OpenZeppelin Math.mulDiv XOR Operator (FALSE POSITIVE)",
      "severity": "NONE",
      "triageResult": "FALSE_POSITIVE",
      "originalSeverity": "HIGH",
      "impact": "NONE",
      "likelihood": "NONE",
      "contract": "Math (OpenZeppelin)",
      "address": "N/A",
      "file": "node_modules/@openzeppelin/contracts/utils/math/Math.sol",
      "lines": "257",
      "function": "mulDiv",
      "category": "incorrect-exp",
      "description": "Slither flags XOR usage as potential exponentiation issue. This is intentional bitwise XOR in OpenZeppelin's Newton-Raphson iteration for modular inverse calculation.",
      "recommendation": "No action required - intentional OZ optimization",
      "status": "FALSE_POSITIVE",
      "exploitable": false,
      "cvss": 0
    },
    {
      "id": "M-01",
      "title": "Divide Before Multiply Precision Loss",
      "severity": "MEDIUM",
      "impact": "MEDIUM",
      "likelihood": "MEDIUM",
      "contract": "Multiple",
      "address": "various",
      "file": "Multiple files",
      "lines": "various",
      "function": "various",
      "category": "precision-loss",
      "description": "Several calculations divide before multiplying, causing precision loss with small amounts.",
      "recommendation": "Use OpenZeppelin Math.mulDiv for precise calculations",
      "status": "OPEN",
      "exploitable": false,
      "cvss": 4.5
    },
    {
      "id": "M-02",
      "title": "Timestamp Dependency",
      "severity": "MEDIUM",
      "impact": "MEDIUM",
      "likelihood": "LOW",
      "contract": "Multiple",
      "address": "various",
      "file": "Multiple files",
      "lines": "various",
      "function": "various",
      "category": "timestamp-dependency",
      "description": "Many functions use block.timestamp for critical logic. Can be manipulated by validators within ~15 seconds.",
      "recommendation": "Use block numbers or external time oracles for high-value operations",
      "status": "ACKNOWLEDGED",
      "exploitable": false,
      "cvss": 3.5
    },
    {
      "id": "M-03",
      "title": "Missing Zero-Address Checks",
      "severity": "MEDIUM",
      "impact": "MEDIUM",
      "likelihood": "LOW",
      "contract": "Multiple",
      "address": "various",
      "file": "Multiple files",
      "lines": "various",
      "function": "setter functions",
      "category": "input-validation",
      "description": "Some setter functions for critical addresses lack zero-address validation.",
      "recommendation": "Add require(newAddress != address(0)) checks",
      "status": "OPEN",
      "exploitable": false,
      "cvss": 3.0
    },
    {
      "id": "M-04",
      "title": "No Maximum Fee Limit",
      "severity": "MEDIUM",
      "impact": "MEDIUM",
      "likelihood": "LOW",
      "contract": "AxiomV2",
      "address": "0x864F9c6f50dC5Bd244F5002F1B0873Cd80e2539D",
      "file": "contracts/AxiomV2.sol",
      "lines": "311-325",
      "function": "setFeeConfig",
      "category": "business-logic",
      "description": "setFeeConfig allows transfer fees up to 100% (10000 BPS).",
      "recommendation": "Implement reasonable maximum fee caps (e.g., 10% max)",
      "status": "OPEN",
      "exploitable": false,
      "cvss": 3.5
    },
    {
      "id": "M-05",
      "title": "Centralized Admin Control",
      "severity": "MEDIUM",
      "impact": "HIGH",
      "likelihood": "LOW",
      "contract": "All",
      "address": "0x2bB2c2A7a1d82097488bf0b9c2a59c1910CD8D5d",
      "file": "All contracts",
      "lines": "constructors",
      "function": "constructor",
      "category": "centralization",
      "description": "Single address holds all admin roles across all contracts. Single point of failure.",
      "recommendation": "Implement timelock and multisig governance",
      "status": "ACKNOWLEDGED",
      "exploitable": false,
      "cvss": 5.0
    },
    {
      "id": "M-06",
      "title": "No Timelock on Critical Functions",
      "severity": "MEDIUM",
      "impact": "HIGH",
      "likelihood": "LOW",
      "contract": "All",
      "address": "various",
      "file": "All contracts",
      "lines": "various",
      "function": "admin functions",
      "category": "governance",
      "description": "Admin functions execute immediately without timelock delay. Users cannot react to malicious changes.",
      "recommendation": "Add OpenZeppelin TimelockController for critical operations",
      "status": "OPEN",
      "exploitable": false,
      "cvss": 5.0
    }
  ],
  "contracts": [
    {
      "name": "AxiomV2",
      "address": "0x864F9c6f50dC5Bd244F5002F1B0873Cd80e2539D",
      "category": "Core Token",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "PAUSER_ROLE", "MINTER_ROLE", "COMPLIANCE_ROLE", "RESCUER_ROLE", "FEE_MANAGER_ROLE", "ORACLE_MANAGER_ROLE", "TREASURY_ROLE"],
      "findings": ["M-04"],
      "riskScore": 3.5
    },
    {
      "name": "DePINNodeSuite",
      "address": "0x16dC3884d88b767D99E0701Ba026a1ed39a250F1",
      "category": "DePIN",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE", "NODE_MANAGER_ROLE"],
      "findings": ["H-01"],
      "riskScore": 7.5
    },
    {
      "name": "DePINNodeSales",
      "address": "0x876951CaE4Ad48bdBfba547Ef4316Db576A9Edbd",
      "category": "DePIN",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE", "OPERATOR_ROLE", "PRICE_MANAGER_ROLE"],
      "findings": ["H-04"],
      "riskScore": 2.5
    },
    {
      "name": "LeaseAndRentEngine",
      "address": "0x26a20dEa57F951571AD6e518DFb3dC60634D5297",
      "category": "Real Estate",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE"],
      "findings": ["H-02"],
      "riskScore": 7.5
    },
    {
      "name": "AxiomSusuHub",
      "address": "0x6C69D730327930B49A7997B7b5fb0865F30c95A5",
      "category": "Community",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE", "TREASURY_ROLE", "POOL_MANAGER_ROLE"],
      "findings": ["H-03"],
      "riskScore": 6.0
    },
    {
      "name": "SustainabilityHub",
      "address": "0xAf4dF8a7733BAB64b7Ce83F2494d6446eF9eC046",
      "category": "Sustainability",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE"],
      "findings": ["H-05"],
      "riskScore": 2.0
    },
    {
      "name": "AxiomExchangeHub",
      "address": "0xF660d260a0bBC690a8ab0f1e6A41049FC919A34D",
      "category": "DEX",
      "verified": true,
      "pausable": true,
      "roles": ["DEFAULT_ADMIN_ROLE", "ADMIN_ROLE"],
      "findings": [],
      "riskScore": 4.0
    }
  ],
  "architectureFindings": {
    "upgradeability": {
      "status": "NONE",
      "proxyPattern": false,
      "uups": false,
      "transparent": false,
      "beacon": false,
      "risk": "LOW",
      "note": "All contracts are immutable. No upgrade path exists."
    },
    "accessControl": {
      "pattern": "OpenZeppelin AccessControl",
      "centralized": true,
      "adminAddress": "0x2bB2c2A7a1d82097488bf0b9c2a59c1910CD8D5d",
      "multisig": false,
      "timelock": false,
      "risk": "MEDIUM",
      "note": "Single address controls all admin roles"
    },
    "reentrancy": {
      "guardUsed": true,
      "pattern": "OpenZeppelin ReentrancyGuard",
      "coverage": "FULL",
      "risk": "LOW",
      "note": "All fund-handling functions protected"
    },
    "pausability": {
      "implemented": true,
      "pattern": "OpenZeppelin Pausable",
      "coverage": "ALL",
      "risk": "LOW",
      "note": "All critical contracts can be paused by admin"
    }
  },
  "recommendations": {
    "critical": [
      {
        "priority": 1,
        "action": "Fix arbitrary transferFrom in DePINNodeSuite.createLease() - Add require(msg.sender == lessee)",
        "effort": "LOW",
        "impact": "HIGH"
      },
      {
        "priority": 2,
        "action": "Fix arbitrary transferFrom in LeaseAndRentEngine.createLease() - Add require(msg.sender == tenant)",
        "effort": "LOW",
        "impact": "HIGH"
      }
    ],
    "high": [
      {
        "priority": 3,
        "action": "Replace weak PRNG in AxiomSusuHub with Chainlink VRF or document limitation",
        "effort": "HIGH",
        "impact": "HIGH"
      },
      {
        "priority": 4,
        "action": "Add maximum fee limits in AxiomV2.setFeeConfig()",
        "effort": "LOW",
        "impact": "MEDIUM"
      },
      {
        "priority": 5,
        "action": "Implement timelock for admin functions changing critical addresses",
        "effort": "MEDIUM",
        "impact": "HIGH"
      },
      {
        "priority": 6,
        "action": "Implement multisig governance for treasury address",
        "effort": "MEDIUM",
        "impact": "HIGH"
      }
    ],
    "medium": [
      {
        "priority": 7,
        "action": "Add zero-address checks to all setter functions",
        "effort": "LOW",
        "impact": "LOW"
      },
      {
        "priority": 8,
        "action": "Add comprehensive event emissions for all state changes",
        "effort": "MEDIUM",
        "impact": "LOW"
      },
      {
        "priority": 9,
        "action": "Improve NatSpec documentation coverage",
        "effort": "MEDIUM",
        "impact": "LOW"
      }
    ]
  },
  "slitherStats": {
    "high": 12,
    "medium": 30,
    "low": 137,
    "informational": 89,
    "reportFile": "slither-report.json",
    "sarifFile": "slither-report.sarif"
  }
}
